# -*- coding: utf-8 -*-
import os
import sys
from dotenv import load_dotenv

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏ Windows
if sys.stdout.encoding != 'utf-8':
    sys.stdout.reconfigure(encoding='utf-8')

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—É—Ç—å –∫ .env —Ä—è–¥–æ–º —Å config.py
BASE_DIR = os.path.dirname(os.path.abspath(__file__))
ENV_PATH = os.path.join(BASE_DIR, ".env")

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
if os.path.exists(ENV_PATH):
    load_dotenv(dotenv_path=ENV_PATH, override=True)
    print(f"[OK] .env loaded: {ENV_PATH}")
else:
    print(f"[WARN] .env not found at {ENV_PATH}")


class Config:
    GROQ_API_KEY = os.getenv("GROQ_API_KEY")
    TELEGRAM_TOKEN = os.environ.get('TELEGRAM_TOKEN')
    TELEGRAM_URL = f"https://api.telegram.org/bot{TELEGRAM_TOKEN}"

    # Google Sheets - –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è Railway
    GOOGLE_CREDENTIALS_JSON = os.environ.get('GOOGLE_CREDENTIALS_JSON')
    GOOGLE_SHEET_NAME = "ORTOS Appointments"

    # –ë–∏—Ç—Ä–∏–∫—Å24
    BITRIX_WEBHOOK_URL = os.environ.get('BITRIX_WEBHOOK_URL')
    BITRIX_BOT_NAME = os.environ.get('BITRIX_BOT_NAME')
    BITRIX_BOT_CODE = os.environ.get('BITRIX_BOT_CODE')

    # –ù–∞—Å—Ç—Ä–æ–π–∫–∏
    CACHE_TIMEOUT = 300

    # –ü—É—Ç–∏ (–¥–ª—è Railway)
    FEEDS_DIR = os.path.join(BASE_DIR, 'data/feeds')
    STELKI_FILE = os.path.join(BASE_DIR, 'data/stelki.txt')
    LOGS_FILE = os.path.join(BASE_DIR, 'data/chat_logs.txt')

    # –ú–æ–¥–µ–ª–∏ Groq
    SEARCH_MODEL = "llama-3.1-8b-instant"
    CONSULT_MODEL = "llama-3.1-8b-instant"

    # llama-3.3-70b-versatile
    # –°–∞–ª–æ–Ω—ã
    SALONS = {
        '–≥–∏–∫–∞–ª–æ': 'gikalo.xml',
        '—ç–Ω–≥–µ–ª—å—Å–∞': 'engelsa.xml',
        '–ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π': 'pobediteley.xml',
        '–¥–∑–µ—Ä–∂–∏–Ω—Å–∫–æ–≥–æ': 'dzerzhinskogo.xml',
        '–ø—Ä–∏—Ç—ã—Ü–∫–æ–≥–æ': 'pritytskogo.xml',
        '—Ä—É—Å—Å–∏—è–Ω–æ–≤–∞': 'russiyanova.xml',
        '—Ñ–∏–ª–∏–º–æ–Ω–æ–≤–∞': 'filimonova.xml',
        '–Ω–∞—Ä–æ—á–∞–Ω—Å–∫–∞—è': 'narochanskaya.xml',
        '–±—Ä–µ—Å—Ç': 'brest.xml',
        '–≤–∏—Ç–µ–±—Å–∫': 'vitebsk.xml',
        '–≥–æ–º–µ–ª—å': 'gomel.xml',
        '–≥—Ä–æ–¥–Ω–æ': 'grodno.xml',
        '–º–æ–≥–∏–ª–µ–≤': 'mogilev.xml',
        '–∂–¥–∞–Ω–æ–≤–∏—á–∏': 'zhdanovichi.xml'
    }

    # –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã
    QUICK_ANSWERS = {
        '—Ü–µ–Ω–∞': 'üí∞ **–¶–µ–Ω—ã –Ω–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Å—Ç–µ–ª—å–∫–∏:**\n‚Ä¢ –î–µ—Ç—Å–∫–∏–µ ‚Äî 290 —Ä—É–±.\n‚Ä¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç ‚Äî 350 —Ä—É–±.\n‚Ä¢ –ü—Ä–µ–º–∏—É–º ‚Äî 390 —Ä—É–±.\n‚Ä¢ –°–ª–æ–∂–Ω—ã–µ ‚Äî 450 —Ä—É–±.\n\nüìû –ü–æ–¥—Ä–æ–±–Ω–µ–µ: +375 (29) 145-03-03',
        '—Å—Ç–æ–∏–º–æ—Å—Ç—å': 'üí∞ **–¶–µ–Ω—ã –Ω–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Å—Ç–µ–ª—å–∫–∏:**\n‚Ä¢ –î–µ—Ç—Å–∫–∏–µ ‚Äî 290 —Ä—É–±.\n‚Ä¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç ‚Äî 350 —Ä—É–±.\n‚Ä¢ –ü—Ä–µ–º–∏—É–º ‚Äî 390 —Ä—É–±.\n‚Ä¢ –°–ª–æ–∂–Ω—ã–µ ‚Äî 450 —Ä—É–±.\n\nüìû –£—Ç–æ—á–Ω–∏—Ç—å: +375 (29) 145-03-03',
        '—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç': 'üí∞ **–¶–µ–Ω—ã –Ω–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Å—Ç–µ–ª—å–∫–∏:**\n‚Ä¢ –î–µ—Ç—Å–∫–∏–µ ‚Äî 290 —Ä—É–±.\n‚Ä¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç ‚Äî 350 —Ä—É–±.\n‚Ä¢ –ü—Ä–µ–º–∏—É–º ‚Äî 390 —Ä—É–±.\n‚Ä¢ –°–ª–æ–∂–Ω—ã–µ ‚Äî 450 —Ä—É–±.\n\nüìû –£—Ç–æ—á–Ω–∏—Ç—å: +375 (29) 145-03-03',
        '—Å—Ä–æ–∫ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è': '‚è±Ô∏è **–°—Ä–æ–∫ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö —Å—Ç–µ–ª–µ–∫: –¥–æ 20 –¥–Ω–µ–π**\n\nüìû –£—Ç–æ—á–Ω–∏—Ç—å: +375 (29) 145-03-03',
        '—Å–∫–æ–ª—å–∫–æ –¥–µ–ª–∞—é—Ç': '‚è±Ô∏è **–°—Ä–æ–∫ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö —Å—Ç–µ–ª–µ–∫: –¥–æ 20 –¥–Ω–µ–π**\n\nüìû –£—Ç–æ—á–Ω–∏—Ç—å: +375 (29) 145-03-03',
        '–∫–æ–Ω—Ç–∞–∫—Ç—ã': 'üìû **–¢–µ–ª–µ—Ñ–æ–Ω—ã:** +375 (29) 145-03-03, +375 (17) 355-77-03\nüìß **Email:** online@ortos.by\nüí¨ **–ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã:** Telegram, Viber, WhatsApp',
        '–∞–¥—Ä–µ—Å': 'üìç **–ù–∞—à–∏ —Å–∞–ª–æ–Ω—ã ORTOS:**\n\nüèôÔ∏è **–ú–∏–Ω—Å–∫:**\n‚Ä¢ —É–ª. –ì–∏–∫–∞–ª–æ, 1\n‚Ä¢ —É–ª. –≠–Ω–≥–µ–ª—å—Å–∞, 34\n‚Ä¢ –ø—Ä-—Ç –ü–æ–±–µ–¥–∏—Ç–µ–ª–µ–π, 65\n‚Ä¢ –∏ –¥—Ä—É–≥–∏–µ...\n\nüèõÔ∏è **–î—Ä—É–≥–∏–µ –≥–æ—Ä–æ–¥–∞:**\n‚Ä¢ –ë—Ä–µ—Å—Ç, –í–∏—Ç–µ–±—Å–∫, –ì–æ–º–µ–ª—å, –ì—Ä–æ–¥–Ω–æ, –ú–æ–≥–∏–ª–µ–≤\n\nüìû **–¢–µ–ª–µ—Ñ–æ–Ω:** +375 (29) 145-03-03',
        '–º–∏–Ω—Å–∫': 'üìç **–°–∞–ª–æ–Ω—ã ORTOS –≤ –ú–∏–Ω—Å–∫–µ:**\n‚Ä¢ —É–ª. –ì–∏–∫–∞–ª–æ, 1\n‚Ä¢ —É–ª. –≠–Ω–≥–µ–ª—å—Å–∞, 34\n‚Ä¢ –ø—Ä-—Ç –ü–æ–±–µ–¥–∏—Ç–µ–ª–µ–π, 65\n‚Ä¢ –ø—Ä-—Ç –î–∑–µ—Ä–∂–∏–Ω—Å–∫–æ–≥–æ, 122\n‚Ä¢ —É–ª. –ü—Ä–∏—Ç—ã—Ü–∫–æ–≥–æ, 158\n‚Ä¢ —É–ª. –†—É—Å—Å–∏—è–Ω–æ–≤–∞, 4\n‚Ä¢ —É–ª. –§–∏–ª–∏–º–æ–Ω–æ–≤–∞, 55\n‚Ä¢ —É–ª. –ù–∞—Ä–æ—á–∞–Ω—Å–∫–∞—è, 8\n\nüìû **–¢–µ–ª–µ—Ñ–æ–Ω:** +375 (29) 145-03-03',
        '–≥–∏–∫–∞–ª–æ': 'üìç **–°–∞–ª–æ–Ω ORTOS –Ω–∞ –ì–∏–∫–∞–ª–æ, 1**\n—É–ª. –ì–∏–∫–∞–ª–æ, 1, –ú–∏–Ω—Å–∫\n\n‚è∞ 9:00-20:00\nüìû +375 (29) 151-77-03\nüìû +375 (29) 279-77-03',
        '–≤—ã–µ–∑–¥': 'üöó **–í—ã–µ–∑–¥–Ω—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–º —Å—Ç–µ–ª—å–∫–∞–º**\n\nORTOS –ø—Ä–æ–≤–æ–¥–∏—Ç –≤—ã–µ–∑–¥–Ω—ã–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –≤ –≥–æ—Ä–æ–¥–∞—Ö –ë–µ–ª–∞—Ä—É—Å–∏.\n\nüìã **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å:**\nortos.by/news/vyezdnoy-kabinet-po-izgotovleniyu-individualnykh-ortopedicheskikh-stelek/\n\nüìû **–î–ª—è –∑–∞–ø–∏—Å–∏:** +375 (29) 145-03-03',
        '—Ä–µ–≥–∏–æ–Ω—ã': 'üìç **–°–∞–ª–æ–Ω—ã ORTOS –≤ —Ä–µ–≥–∏–æ–Ω–∞—Ö:**\n‚Ä¢ –ë—Ä–µ—Å—Ç: —É–ª. –°–æ–≤–µ—Ç—Å–∫–∞—è, 59\n‚Ä¢ –í–∏—Ç–µ–±—Å–∫: —É–ª. –ö–∏—Ä–æ–≤–∞, 7\n‚Ä¢ –ì–æ–º–µ–ª—å: —É–ª. –ö—Ä–µ—Å—Ç—å—è–Ω—Å–∫–∞—è, 32\n‚Ä¢ –ú–æ–≥–∏–ª–µ–≤: —É–ª. –ë—É–¥–µ–Ω–Ω–æ–≥–æ, 13\n‚Ä¢ –ì—Ä–æ–¥–Ω–æ: –ø—Ä-—Ç –Ø–Ω–∫–∏ –ö—É–ø–∞–ª—ã, 87\n‚Ä¢ –ñ–¥–∞–Ω–æ–≤–∏—á–∏: –∞–≥. –ñ–¥–∞–Ω–æ–≤–∏—á–∏, 81/5\n\nüìû **–¢–µ–ª–µ—Ñ–æ–Ω:** +375 (29) 145-03-03',
        '—Ç–µ–ª–µ—Ñ–æ–Ω': 'üìû **–¢–µ–ª–µ—Ñ–æ–Ω—ã –¥–ª—è —Å–≤—è–∑–∏:**\n+375 (29) 145-03-03\n+375 (17) 355-77-03\n\nüí¨ –ü–∏—à–∏—Ç–µ –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞—Ö!',
        '–ø–æ–∑–≤–æ–Ω–∏—Ç—å': 'üìû **–ó–≤–æ–Ω–∏—Ç–µ!**\n+375 (29) 145-03-03\n+375 (17) 355-77-03\n\n‚è∞ –†–∞–±–æ—Ç–∞–µ–º —Å 9:00 –¥–æ 18:00',
        '—Å–∞–π—Ç': 'üåê **–ù–∞—à —Å–∞–π—Ç:** ortos.by\n\n–¢–∞–º –≤—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–∞—Ö, —É—Å–ª—É–≥–∞—Ö –∏ —Å–∞–ª–æ–Ω–∞—Ö!',
        '—Ç—Ä–∏–∫–æ—Ç–∞–∂': 'ü©∫ **–ö–æ–º–ø—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π —Ç—Ä–∏–∫–æ—Ç–∞–∂ ORTOS:**\n‚Ä¢ –õ–µ—á–µ–±–Ω—ã–π –∏ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π\n‚Ä¢ –û—Ç –æ—Ç–µ–∫–æ–≤, –≤–∞—Ä–∏–∫–æ–∑–∞\n‚Ä¢ –î–ª—è —Å–ø–æ—Ä—Ç–∞ –∏ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ—Å—Ç–∏\n\nüìû **–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è:** +375 (29) 145-03-03',
        '–∞–∫—Ü–∏—è': 'üéÅ **–ê–∫—Ü–∏—è –Ω–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Å—Ç–µ–ª—å–∫–∏!**\n\n–ü—Ä–∏ –ø–æ–∫—É–ø–∫–µ –æ—Ç 2-—Ö —Å—Ç–µ–ª–µ–∫ –ø–æ –æ–¥–Ω–æ–º—É —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É –∑–∞–¥–∞–Ω–∏—é - —Å–∫–∏–¥–∫–∞ 20% –Ω–∞ –≤—Ç–æ—Ä—É—é –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä—ã!\n\nüí° **–°–∫–∏–¥–∫–∞ –¥–µ–π—Å—Ç–≤—É–µ—Ç:**\n‚Ä¢ –ü—Ä–∏ –ø–æ–∫—É–ø–∫–µ —Å—Ä–∞–∑—É\n‚Ä¢ –ò–ª–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 3 –º–µ—Å—è—Ü–µ–≤ –ø–æ—Å–ª–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏\n\nüìû **–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏:** +375 (29) 145-03-03'
    }

    @classmethod
    def get_google_credentials(cls):
        """–ü–æ–ª—É—á–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ Google"""
        if cls.GOOGLE_CREDENTIALS_JSON:
            import json
            return json.loads(cls.GOOGLE_CREDENTIALS_JSON)
        else:
            # –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ - —Ñ–∞–π–ª credentials.json
            credentials_file = os.path.join(BASE_DIR, 'credentials.json')
            if os.path.exists(credentials_file):
                import json
                with open(credentials_file, 'r') as f:
                    return json.load(f)
            else:
                raise Exception(
                    "Google credentials not found. Set GOOGLE_CREDENTIALS_JSON environment variable")
